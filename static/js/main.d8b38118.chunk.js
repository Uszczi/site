(this.webpackJsonpsite=this.webpackJsonpsite||[]).push([[0],{100:function(t,e){},101:function(t,e,n){},102:function(t,e,n){"use strict";n.r(e);var i=n(21),o=n.n(i),a=n(52),s=n.n(a);n(78),n(79);var r=function(){return o.a.createElement("div",{className:"Footer"},"Footer")};var h=function(){return o.a.createElement("div",{className:"Header"},"Header")},c=n(6),u=n(11),l=n(13),d=n(14),f=n(53),v=n.n(f),m=n(15),p=n(32),y=function(){function t(e,n,i,o,a){Object(c.a)(this,t),this.p=a,e instanceof p.a?(this.model=e,this.input_nodes=n,this.hidden_nodes=i,this.output_nodes=o):(this.input_nodes=e,this.hidden_nodes=n,this.output_nodes=i,this.model=this.createModel())}return Object(u.a)(t,[{key:"copy",value:function(e){var n=this;return p.g((function(){for(var i=n.createModel(),o=n.model.getWeights(),a=[],s=0;s<o.length;s++)a[s]=o[s].clone();return i.setWeights(a),new t(i,n.input_nodes,n.hidden_nodes,n.output_nodes,e)}))}},{key:"mutate",value:function(t){var e=this;p.g((function(){for(var n=e.model.getWeights(),i=[],o=0;o<n.length;o++){for(var a=n[o],s=n[o].shape,r=a.dataSync().slice(),h=0;h<r.length;h++)if(Math.random(1)<t){var c=r[h];r[h]=c+e.p.randomGaussian()}var u=p.e(r,s);i[o]=u}e.model.setWeights(i)}))}},{key:"dispose",value:function(){this.model.dispose()}},{key:"predict",value:function(t){var e=this;return p.g((function(){var n=p.f([t]);return e.model.predict(n).dataSync()}))}},{key:"createModel",value:function(){var t=p.c(),e=p.b.dense({units:this.hidden_nodes,inputShape:[this.input_nodes],activation:"sigmoid"});t.add(e);var n=p.b.dense({units:this.output_nodes,activation:"softmax"});return t.add(n),t}}]),t}();function g(t){var e,n=function(){function e(t,n,i){Object(c.a)(this,e),this.x=t,this.amount=n,this.width=r*n,this.height=20*i}return Object(u.a)(e,[{key:"show",value:function(){t.fill(0),t.rect(this.x,400-this.height,this.width,this.height)}},{key:"update",value:function(){this.x-=h}},{key:"colision",value:function(t,e){return t+20>=this.x&&t<=this.x+this.width&&e>=400-this.height}},{key:"behindScene",value:function(){return this.x<-50}}]),e}(),i=function(){function t(e,n){Object(c.a)(this,t),this.p=n,this.position_X=100,this.position_Y=200,this.height=50,this.bottom_Y=this.position_Y-this.height,this.gravity=.6,this.velocity=0,this.lift=-10,this.score=0,this.fitness=0,this.brain=e?e.copy(n):new y(4,4,2,n)}return Object(u.a)(t,[{key:"show",value:function(){this.p.fill(0),this.p.rect(this.position_X,this.bottom_Y-this.height,20,this.height)}},{key:"update",value:function(){this.score++,this.velocity+=this.gravity,this.velocity>16&&(this.velocity=16),this.bottom_Y+this.velocity>400?(this.bottom_Y=400,this.velocity=0):this.bottom_Y+=this.velocity,this.show()}},{key:"dispose",value:function(){this.brain.dispose()}},{key:"jump_low",value:function(){this.isGrounded()&&(this.velocity=this.lift)}},{key:"jump_high",value:function(){this.isGrounded()&&(this.velocity=1.2*this.lift)}},{key:"isGrounded",value:function(){return 400===this.bottom_Y}},{key:"mutate",value:function(){this.brain.mutate(g)}},{key:"think",value:function(t){for(var e=null,n=1/0,i=0;i<t.length;i++){var o=t[i].x-this.position_X;o<n&&o>0&&(e=t[i],n=o)}var a=[];a[0]=e.x,a[1]=this.bottom_Y,a[2]=e.width,a[3]=e.height;var s=this.brain.predict(a);s[0]>s[1]&&this.jump_low()}}]),t}(),o=!0,a=[1,1,1,2,2,3],s=[1,1,1,1,1,1,1,1,2,2],r=22,h=6,l=0,d=[],f=[],v=[],g=.1,b=1;function _(){w();for(var t=0;t<20;t++)f[t]=k();for(var e=0;e<20;e++)v[e].dispose();v=[]}function k(){for(var e=0,n=t.random(1);n>0;)n-=v[e].fitness,e++;e--;var o=v[e],a=new i(o.brain,t);return a.mutate(),a}t.setup=function(){t.createCanvas(1e3,500);var n=t.createP("Speed: ");(e=t.createSlider(1,10,1)).parent(n),p.d("cpu");for(var o=0;o<20;o++)f.push(new i(null,t))};var w=function(){var t,e=0,n=Object(m.a)(v);try{for(n.s();!(t=n.n()).done;){e+=t.value.score}}catch(s){n.e(s)}finally{n.f()}var i,o=Object(m.a)(v);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.fitness=a.score/e}}catch(s){o.e(s)}finally{o.f()}};function j(){if(l%90===0){var e=t.random(100,300),i=t.random(a),o=t.random(s);d.push(new n(1e3+e,i,o)),l=0}l++}function x(){for(var t=0;t<d.length;t++){d[t].update(),d[t].show();for(var e=0;e<f.length;e++)d[t].colision(f[e].position_X,f[e].bottom_Y)&&v.push(f.splice(e,1)[0])}}function E(){for(var t=d.length-1;t>=0;t--)d[t].behindScene()&&d.splice(t,1)}t.draw=function(){if(o){for(var n=0;n<e.value();n++){t.background(189,96,96),t.line(0,400,1e3,400),j(),x(),E();var i,a=Object(m.a)(f);try{for(a.s();!(i=a.n()).done;){var s=i.value;s.think(d),s.update()}}catch(h){a.e(h)}finally{a.f()}0===f.length&&(l=0,_(),b++,d=[])}t.textSize(32);var r=f.length;t.text("Generation: "+b,500,30),t.text("Live: "+r,30,30),o=!1}}}var b=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(){return Object(c.a)(this,n),e.call(this)}return Object(u.a)(n,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(v.a,{sketch:g}))}}]),n}(i.Component);var _=function(){return o.a.createElement("div",{className:"Main"},o.a.createElement(b,null))};n(101);var k=function(){return o.a.createElement("div",{className:"MyBody"},o.a.createElement(h,null),o.a.createElement(_,null),o.a.createElement(r,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},73:function(t,e,n){t.exports=n(102)},78:function(t,e,n){},79:function(t,e,n){},84:function(t,e){},85:function(t,e){},93:function(t,e){},99:function(t,e){}},[[73,1,2]]]);
//# sourceMappingURL=main.d8b38118.chunk.js.map